<!DOCTYPE html>
<html>
<head>
	<title>Jabont - The Puzzle Game</title>
	<meta charset="utf-8">
	<!-- link css file -->
	<link rel="stylesheet" type="text/css" href="style.css">
	<meta charset=utf-8>
	<meta name=description content="">
	<meta name=viewport content="width=device-width, initial-scale=1">
</head>
<body>
	<main>
		<div id="heading">
			<div class="demo"></div>
			<h2 class="title">The Puzzle <a href="#!" onclick="rand()">Random!</a></h2>

		</div>
		<div id="gamezone">
			<script>
				for (var x = 0; x < 5; x++) {
					for (var y = 0; y < 5; y++) {
						if (x!=5 && y!=5) {
							document.write(`<div id="b_${x}_${y}" class="minibox box-y-${y} box-x-${x}" y="${y}" x="${x}" onclick="goGogoGogo(this)" check='1'></div>`)
						}
					}
				}
				b_4_4.outerHTML = '';
			</script> 
		</div>

		<h2 class="title">Count: <span id="theCount">0</span></h2>
	</main>
	<script>
		let blankX = 4
		let blankY = 4
		let count = 0

		function goGogoGogo(box){
			let thisX = parseInt(box.getAttribute('x'))
			let thisY = parseInt(box.getAttribute('y'))
			if (thisX == blankX || thisY == blankY) {
				if (thisX == blankX) {
					if (thisY == (blankY-1) || thisY == (blankY+1)) {
						box.setAttribute('y',blankY)
						blankX = thisX;
						blankY = thisY;
						count++;
						theCount.innerHTML = count;
					}
				}
				if (thisY == blankY) {
					if (thisX == (blankX-1) || thisX == (blankX+1)) {
						box.setAttribute('x',blankX)
						blankX = thisX;
						blankY = thisY;
						count++;
						theCount.innerHTML = count;
					}
				}
				let thisID = box.getAttribute('id').split("_");
				if (box.getAttribute('x') == thisID[1] && box.getAttribute('y') == thisID[2]) {
					box.setAttribute('check',1)
				}
				else{
					box.setAttribute('check',0)	
				}
				if (document.querySelectorAll('.minibox[check="1"]').length == 24) {
					setTimeout(function(){
						alert('Mission Compete')
						theCount.innerHTML = count+" - Mission Compete";
						document.body.style.setProperty('--bd','#fff0');
						gamezone.style.backgroundImage = 'url(pic.jpg)';
					},150)
				}
			}
			else{
				console.log('บึ้มมม')
			}

		}
		function rand(){
			document.body.style.setProperty('--bd','#fff6');
			gamezone.style.backgroundImage = 'none';
			gamezone.innerHTML = `<div id="b_0_0" class="minibox box-y-0 box-x-0" y="0" x="0" onclick="goGogoGogo(this)"></div><div id="b_0_1" class="minibox box-y-1 box-x-0" y="1" x="0" onclick="goGogoGogo(this)"></div><div id="b_0_2" class="minibox box-y-2 box-x-0" y="4" x="1" onclick="goGogoGogo(this)"></div><div id="b_0_3" class="minibox box-y-3 box-x-0" y="4" x="2" onclick="goGogoGogo(this)"></div><div id="b_0_4" class="minibox box-y-4 box-x-0" y="3" x="0" onclick="goGogoGogo(this)"></div><div id="b_1_0" class="minibox box-y-0 box-x-1" y="1" x="3" onclick="goGogoGogo(this)"></div><div id="b_1_1" class="minibox box-y-1 box-x-1" y="3" x="1" onclick="goGogoGogo(this)"></div><div id="b_1_2" class="minibox box-y-2 box-x-1" y="2" x="0" onclick="goGogoGogo(this)"></div><div id="b_1_3" class="minibox box-y-3 box-x-1" y="0" x="1" onclick="goGogoGogo(this)"></div><div id="b_1_4" class="minibox box-y-4 box-x-1" y="4" x="0" onclick="goGogoGogo(this)"></div><div id="b_2_0" class="minibox box-y-0 box-x-2" y="1" x="1" onclick="goGogoGogo(this)"></div><div id="b_2_1" class="minibox box-y-1 box-x-2" y="0" x="4" onclick="goGogoGogo(this)"></div><div id="b_2_2" class="minibox box-y-2 box-x-2" y="3" x="2" onclick="goGogoGogo(this)"></div><div id="b_2_3" class="minibox box-y-3 box-x-2" y="0" x="3" onclick="goGogoGogo(this)"></div><div id="b_2_4" class="minibox box-y-4 box-x-2" y="4" x="3" onclick="goGogoGogo(this)"></div><div id="b_3_0" class="minibox box-y-0 box-x-3" y="1" x="4" onclick="goGogoGogo(this)"></div><div id="b_3_1" class="minibox box-y-1 box-x-3" y="1" x="2" onclick="goGogoGogo(this)"></div><div id="b_3_2" class="minibox box-y-2 box-x-3" y="2" x="1" onclick="goGogoGogo(this)"></div><div id="b_3_3" class="minibox box-y-3 box-x-3" y="2" x="2" onclick="goGogoGogo(this)"></div><div id="b_3_4" class="minibox box-y-4 box-x-3" y="3" x="3" onclick="goGogoGogo(this)"></div><div id="b_4_0" class="minibox box-y-0 box-x-4" y="0" x="2" onclick="goGogoGogo(this)"></div><div id="b_4_1" class="minibox box-y-1 box-x-4" y="2" x="4" onclick="goGogoGogo(this)"></div><div id="b_4_2" class="minibox box-y-2 box-x-4" y="3" x="4" onclick="goGogoGogo(this)"></div><div id="b_4_3" class="minibox box-y-3 box-x-4" y="4" x="4" onclick="goGogoGogo(this)"></div> `
			blankX = 3;
			blankY = 2;
			for (let i = 0; i < 40; i++) {
				setTimeout(function(){
					let arr = [];
					arr[0] = blankX-1;
					arr[1] = blankX+1;
					arr[2] = blankY-1;
					arr[3] = blankY+1;
					let r = parseInt(Math.random()*100)%4;
					console.log(r+' '+arr[r]);
					if (r<2) {
						if (arr[r] == 5) {
							document.querySelector(`.minibox[y="${arr[2]}"][x="${blankX}"]`).click();
						}
						else if(arr[r] == -1){
							document.querySelector(`.minibox[y="${arr[3]}"][x="${blankX}"]`).click();
						}
						else{
							document.querySelector(`.minibox[y="${blankY}"][x="${arr[r]}"]`).click();
						}

					}
					else{
						if (arr[r] == 5) {
							document.querySelector(`.minibox[y="${blankY}"][x="${arr[0]}"]`).click();
						}
						else if(arr[r] == -1){
							document.querySelector(`.minibox[y="${blankY}"][x="${arr[1]}"]`).click();
						}
						else{
							document.querySelector(`.minibox[y="${arr[r]}"][x="${blankX}"]`).click();
						}
					}
					// if (blankX != 4) {}
					// let r = parseInt(Math.random()*100)%4;
					count=0;
					theCount.innerHTML = count;
				},80*i);
			}
			
		}
	</script> 
</body>
</html>